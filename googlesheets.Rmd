
# Google Sheets

```{r setup, message=FALSE, warning=FALSE}
# Libraries
library(tidyverse)
library(googlesheets4)

# Parameters
  # URL for Gapminder example
url_gapminder <- 
  "https://docs.google.com/spreadsheets/d/1BzfL0kZUz1TsI5zxJF1WNF01IxvC67FbOJUiiGMZ_mQ/"
```

Google Sheets are a useful way to collect, store, and collaboratively work with data. The googlesheets4 package wraps the [Sheets API](https://developers.google.com/sheets/api), making it easy for you to work with Google Sheets in R.

The "4" in googlesheets4 refers to the most recent version (v4) of the Google Sheets API. There's also an R package called googlesheets, which uses an older version (v3) of the Google Sheets API. If you've worked with the googlesheets package previously, note that the Sheets API v3 will be shut down on March 3, 2020, so you'll need to switch over to googlesheets4.  

## Authentication

The Google Sheets API requires you to authenticate to Google. Authentication can be tricky, but, luckily, googlesheets4 mostly handles it all for you. The first time you call a googlesheets4 function that requires authentication, a browser tab will open and prompt you to sign into Google. Sign into your account and then return to RStudio. 

By default, your user credentials will now be stored in a `~/.R/gargle/gargle-oauth` folder directly below your home directory. (gargle is an R package for working with Google APIs.) The next time googlesheets4 requires authentication, it will use these stored credentials.

## Reading

Take a look at our [example sheet](https://docs.google.com/spreadsheets/d/1BzfL0kZUz1TsI5zxJF1WNF01IxvC67FbOJUiiGMZ_mQ/), which stores data from [Gapminder](https://www.gapminder.org/). 

To read in data from a Google Sheet, we need its URL. We've stored the URL of the Gapminder Sheet as `url_gapminder` up in the parameters section. Now, we can use the googlesheets4 function `read_sheet()` to read in the data. `read_sheet()`'s first argument, `ss`, takes the URL.

```{r}
read_sheet(ss = url_gapminder)
```

Notice that the [original Sheet](https://docs.google.com/spreadsheets/d/1BzfL0kZUz1TsI5zxJF1WNF01IxvC67FbOJUiiGMZ_mQ/) contains multiple sheets, one for each continent. We can list all these sheets by using the function `sheets_sheets()`.

```{r}
sheets_sheets(ss = url_gapminder)
```

By default, `sheets_read()` reads  in the first sheet. Here, that's the Africa sheet. If we want to read in Asia, we can specify the `sheet` argument.

```{r}
sheets_read(ss = url_gapminder, sheet = "Asia")
```

## Writing

As of 2019-12-05, you cannot write to Google Sheets with the googlesheets4 package. Check back for updates.

